## Hacking my sleep** {#experimentSleep}

Most people know about the hormone melatonin and that it has something to do with sleep. Some international travelers take it to counter the effects of jet lag, and some people take it regularly as a treatment for insomnia.  You might vaguely remember that it has something to do with the pineal gland, a small organ tucked near your brain, but did you know that your gut contains *400 times*^[@chen_distribution_2011 or https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3198018/] more melatonin?  Something like 80% of its precursors, as well as those of the similar mood-regulating neurotransmitter serotonin are made in the gut^[@cryan_mind-altering_2012 and see the excellent @blaser_missing_2015 for more intriguing details.]

There are other reasons to suspect that sleep and the gut may be linked. Think of all those home remedies for insomnia: a glass of warm milk before bed, apple cider vinegar, non-caffeinated herbal teas -- many of these are foods known to affect the microbiome. 

A quick internet search for "gut microbe serotonin" will lead you to _Bifidobacterium infantis_ [which modulates tryptophan](http://www.pnas.org/content/108/7/3047.long), the stuff in turkey that urban legends have long (and incorrectly) blamed for [that sleepy feeling](http://www.webmd.com/food-recipes/features/the-truth-about-tryptophan) you get after Thanksgiving dinner. If you can raise the level of _B. infantis_, might it also improve sleep?

To understand how to grow these microbiobes, it helps to understand something about the bacterium itself. Fortunately, it's a well-studied organism, first identified back in 1899 as a common inhabitant of the intestines of breast-fed infants. Nowadays you can buy prebiotics that contain lots of bifido – or so they claim. Without rigorous lab independent verification of the claims, it can be hard to tell if the prebiotic form is helpful or not (and frankly, [I'm skeptical](#experimentProbiotics))

Bifido is highly sensitive to oxygen, and flourishes best in environments like the colon that are anaerobic. It's also a strong fermenter of certain types of starches, called resistant starch, so-called because they resist digestion.

One of the best resistant starches is plain old potato starch, made by finely grinding tubers into a light, white powder. You can buy an organic version from *Bob's Red Mill* at most natural foods stores or high-end supermarkets. It's cheap, and tasteless, so it's often used in cooking, as a thickener for sauces.


```{r experimentSleepBobRedMillGraphic, fig.cap="No fiber in here."}

knitr::include_graphics(file.path(here::here(),"Experiments","assets","experimentSleepBobsRedMillNutrition.jpg"))
```


The nutrition label on potato starch shows that it is essentially inert as a food. No calories, vitamins, or minerals, no fat, and not even any fiber. It's just zero on everything, because it passes right through the stomach. When cooked, it becomes a thick, gooey consistency that quickly is absorbed by powerful stomach acids, but if kept in its raw state, it slides right through into the colon.

Not many other foods make it this far undigested, so a rich unfermented wad of fresh potato starch is a real treat for the Bifido of the colon and they quickly begin to make the most of it, fermenting it into the precursors to tryptophan.

Does it work?  To find out, I started with two tablespoons the first day, and then three tablespoons the next. Anything larger might risk unpleasant gas or loose stools until my body adjusts. Within two days, though, it was obvious that something was working. I couldn't believe my excellent sleep that first couple of nights.

After a few days, the sleep effect started to wear off, though I still felt much-improved. But could I trace the improvement to improved levels of Bifido? Let's look at the data.

```{r sleepExperimentSleepBifidoChart, fig.cap = "Potato Starch, Sleep, and Bifidobacterium levels."}
track_file_name <- file.path(here::here(),"assets","Rik Self Tracking 2015.xlsx")

track_data <- readxl::read_excel(track_file_name)

experiment_days <- track_data %>% dplyr::filter(Date < "2015-04-10") %>%
  dplyr::filter(!is.na(`Potato Starch`) & !is.na(Z)) %>%
  select(Date,PS = `Potato Starch`, Z, REM, Alcohol, Deep, `Vitamin D`) %>%
    dplyr::group_by(Week = cut(Date, "1 week")) %>%
  dplyr::mutate(Date = as.Date(Date),# MeanZ = mean(Z, na.rm = TRUE),
         `Potato Starch` = cut(PS,breaks = c(0,.2,2,8), include.lowest = TRUE, labels =c("None", "Low", "High")),
         REM = as.numeric(REM) * 24,
         Deep = as.numeric(Deep) * 24) 


bifido <- mhg_taxa(subset_samples(sprague.genus.norm,Site == "gut" &
                           Date > as.Date("2014-5-15") &
                           Date < as.Date("2015-05-01")),
         "Bifidobacterium") %>% mutate(Date = date, bifido = abundance/10000) %>%
  select(Date,bifido)

# insert one new row (not in my current uBiome Explorer results for some reason, but for which I have JSON data)
bifido <- rbind(bifido,
  c("2015-01-19",bifido = as.numeric(6.6516)))

bifido$bifido <- as.numeric(bifido$bifido)
j <- dplyr::full_join(bifido, experiment_days) %>% as_tibble()
j[is.na(j$`Potato Starch`),]$`Potato Starch` <- "None"

ggplot(data = j  ) +
  geom_point(aes(x=as.Date(Date),y=Z, color = `Potato Starch`)) +
  geom_smooth(inherit.aes = FALSE, data = j %>% dplyr::filter(`Potato Starch` %in% c("Low","None")),
              aes(x=as.Date(Date),y=Z, color = `Potato Starch`),
              method = "lm", se = FALSE) +
  geom_bar( data = j, stat = "identity", aes(x = as.Date(Date), y = bifido),
           color = "black") +
                 scale_y_continuous(sec.axis = sec_axis(~.,
                                                        name = "Bifidobacterium (%)")) +
    scale_x_date(date_labels = "%b", date_breaks = "1 month", date_minor_breaks = "2 weeks") +
  xlim(as.Date("2014-10-04"),as.Date("2015-04-01")) +
  labs(title = "Total Sleep Per Night", x = "Date")
```

As you can see, there is almost no difference in the total sleep I enjoyed on nights following my eating a tablespoon or two of potato starch. I studied the data carefully, looking for possible ways the potato starch may have had an effect, but couldn't find anything.^[You can see the detailed code on [my blog](http://richardsprague.com/post/2019/02/09/reevaluating_sleep_experiments/)] It's worth noting that the sleep times (Z) in my data are calculated with a Zeo sleep tracking device which I wore strapped on my forehead to detect the subtle changes in electrical activity that come with sleep. Zeo let me calculate precise REM and Deep sleep numbers as well, but none of them seemed to be affected by potato starch.^[I tried correlating with other variables too, such as alcohol but found no effect. I *did* find a small effect during the days after taking Vitamin D supplements, but it barely met the bar for statistical significance. If there's an effect, it's not very strong.]

Unfortunately, when I ran this experiment I only received three microbiome results. The first came shortly after beginning to ingest large amounts of potato starch so I don't have a good "before" result. However, I *do* have one result taken after I had stopped the potato starch for several weeks. Both samples taken when consuming potato starch have much higher levels of _Bifidobacterium_ than normal. 

What _is_ normal for me? Here's how I look during a typical three month period. (Figure \@ref(fig:experimentSleepBifidoLevels))

```{r experimentSleepBifidoLevels, fig.cap= "Bifido abundance over time. Red dots are days for which there is a sample. Blue line is the medium value for healthy people. Orange is the average sleep per night for each week."}

people_healthy <- subset_samples(people.gut.norm,Condition == "Healthy")

bifido_healthy_median <- mhg_taxa(people_healthy, "Bifidobacterium") %>% pull(abundance) %>% median()/10000

d <- mhg_taxa(gut.norm.nodupes, "Bifidobacterium") %>% 
  dplyr::filter(date > as.Date("2017-4-01") & date < as.Date("2017-06-01")) %>% mutate(abundance = abundance /10000) %>% 
    group_by(Week = cut(date, "1 week")) %>% 
  mutate(Mean = mean(abundance, na.rm = TRUE)) %>% select(Week, date, Mean, abundance)


df <- rikStats %>% dplyr::filter(Date > as.Date("2017-4-01") & Date < as.Date("2017-06-01")) %>% select(date = Date, Z) %>% dplyr::left_join(d) %>%
    group_by(Week = cut(date, "1 week")) %>% 
  dplyr::mutate(MeanZ = mean(Z)) %>% select(Week, date,Z, MeanZ, Mean, abundance)



ggplot(data=df, aes(x = date, y = abundance)) + geom_bar(stat = "identity") +
  geom_line(aes(x = date, y = Mean), color = "green") + 
  geom_line(aes(x = date, y = MeanZ/3), color = "orange", stat = "identity") + 
                 scale_y_continuous(sec.axis = sec_axis(~.*3,
                                                        name = "Sleep (Weekly Mean)")) +
  geom_point(aes(x = date, y = 0), color = "red") + 
  geom_hline(yintercept = bifido_healthy_median, color = "blue") +
  scale_x_date(date_labels = "%b",
                date_breaks = "1 month", date_minor_breaks = "2 weeks") +
  labs(title = "Bifidobacterium", x = "Date", y = "Abundance (%)")
```

Note that I have some *Bifidobacterium* in just about every sample (the red dots), but it doesn't look like there's a strong relationship with sleep. My daily average sleep (indicated in orange, averaged across the week) seems pretty constant, though the *Bifidobacterium* levels flucuate wildly.

Conclusion: I think it's likely that potato starch increased my natural _Bifidobacterium_ levels. Whether it increased microbes associated with serotonin production is less clear, but it's hard to show that the potato starch caused a noticable change in my sleep.




